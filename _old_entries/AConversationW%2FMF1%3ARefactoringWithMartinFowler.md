http://www.artima.com/intv/refactorP.html